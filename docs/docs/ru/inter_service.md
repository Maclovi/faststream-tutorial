# –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏ ü§ù

–í –ø—Ä–µ–¥—ã–¥—É—â–µ–º —Ä–∞–∑–¥–µ–ª–µ –≤—ã —Å–æ–∑–¥–∞–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ –æ—á–µ—Ä–µ–¥–∏ `input-queue` –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ `output-queue`. –¢–µ–ø–µ—Ä—å –ø–æ—Ä–∞ —É–∑–Ω–∞—Ç—å, –∫–∞–∫ —Å–µ—Ä–≤–∏—Å—ã –º–æ–≥—É—Ç **–≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å** —á–µ—Ä–µ–∑ –±—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π! –í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –º—ã —Å–æ–∑–¥–∞–¥–∏–º –¥–≤–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: –æ–¥–Ω–æ —Å –¥–≤—É–º—è –ø–æ–¥–ø–∏—Å—á–∏–∫–∞–º–∏ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ä–≤–∏—Å–∞, –¥—Ä—É–≥–æ–µ ‚Äî –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Å–µ—Ä–≤–∏—Å–µ. –≠—Ç–æ –Ω–∞–≥–ª—è–¥–Ω–æ –ø–æ–∫–∞–∂–µ—Ç, –∫–∞–∫ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã –æ–±–º–µ–Ω–∏–≤–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–º–∏ —á–µ—Ä–µ–∑ RabbitMQ. –ì–æ—Ç–æ–≤—ã —Å–æ–µ–¥–∏–Ω–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã? –ü–æ–≥–Ω–∞–ª–∏! üöÄ

## –ß—Ç–æ –º—ã —Å–¥–µ–ª–∞–µ–º? üìã

–ú—ã —Å–æ–∑–¥–∞–¥–∏–º –¥–≤–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

- **–ü–µ—Ä–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (`app.py`)**:
    - –°–ª—É—à–∞–µ—Ç –æ—á–µ—Ä–µ–¥—å `input-queue`, –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –µ–≥–æ –≤ –≤–µ—Ä—Ö–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä üî†.
    - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –æ—á–µ—Ä–µ–¥—å `output-queue` –∏ `final-queue` üì§.
    - –°–ª—É—à–∞–µ—Ç –æ—á–µ—Ä–µ–¥—å `output-queue` –∏ –ª–æ–≥–∏—Ä—É–µ—Ç –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç üì•.
- **–í—Ç–æ—Ä–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (`app2.py`)**:
    - –°–ª—É—à–∞–µ—Ç –æ—á–µ—Ä–µ–¥—å `final-queue` –∏ –ª–æ–≥–∏—Ä—É–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç üì•.

–≠—Ç–æ –ø—Ä–∏–º–µ—Ä –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤: –æ–¥–∏–Ω —Å–µ—Ä–≤–∏—Å –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –ø–µ—Ä–µ–¥–∞–µ—Ç –∏—Ö –¥–∞–ª—å—à–µ, –¥—Ä—É–≥–æ–π –ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã. –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–≤–µ –æ—á–µ—Ä–µ–¥–∏ (`output-queue` –∏ `final-queue`), —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å —Ü–µ–ø–æ—á–∫—É –æ–±—Ä–∞–±–æ—Ç–∫–∏.

## –®–∞–≥ 1: –ù–∞–ø–∏—Å–∞–Ω–∏–µ –∫–æ–¥–∞ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ ‚úçÔ∏è

–û–±–Ω–æ–≤–∏—Ç–µ —Ñ–∞–π–ª `app.py` –≤ –ø–∞–ø–∫–µ `faststream-tutorial`, –¥–æ–±–∞–≤–∏–≤ –¥–≤–∞ –ø–æ–¥–ø–∏—Å—á–∏–∫–∞:

```python
--8<-- "src/tutorial/inter_service/app.py"
```

**–ß—Ç–æ –∑–¥–µ—Å—å –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç?** ü§î

- **`RabbitBroker`**: –û–±—ä–µ–∫—Ç –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ RabbitMQ —Å –∞–¥—Ä–µ—Å–æ–º `amqp://guest:guest@localhost:5672/`.
- **`FastStream`**: –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, —É–ø—Ä–∞–≤–ª—è—é—â–µ–µ –±—Ä–æ–∫–µ—Ä–æ–º.
- **`@broker.subscriber("input-queue")`**: –î–µ–∫–æ—Ä–∞—Ç–æ—Ä, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∫–∞–∫ –º–µ—Ç–æ–¥ –±—Ä–æ–∫–µ—Ä–∞, —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é `handle_message` –∫–∞–∫ –ø–æ–¥–ø–∏—Å—á–∏–∫–∞ –Ω–∞ –æ—á–µ—Ä–µ–¥—å `input-queue`. –û–Ω–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ, –ª–æ–≥–∏—Ä—É–µ—Ç –µ–≥–æ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é –≤ `output-queue` –∏ `final-queue`.
- **`broker.publish`**: –ú–µ—Ç–æ–¥ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –¥–≤–µ –æ—á–µ—Ä–µ–¥–∏.
- **`@broker.subscriber("output-queue")`**: –î–µ–∫–æ—Ä–∞—Ç–æ—Ä, —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—â–∏–π —Ñ—É–Ω–∫—Ü–∏—é `check_result` –∫–∞–∫ –ø–æ–¥–ø–∏—Å—á–∏–∫–∞ –Ω–∞ –æ—á–µ—Ä–µ–¥—å `output-queue`. –û–Ω–∞ –ª–æ–≥–∏—Ä—É–µ—Ç –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
- **`handle_message` –∏ `check_result`**: –§—É–Ω–∫—Ü–∏–∏-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é –ª–æ–≥–∏–∫—É –ø–µ—Ä–≤–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞.

## –®–∞–≥ 2: –ù–∞–ø–∏—Å–∞–Ω–∏–µ –∫–æ–¥–∞ –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ ‚úçÔ∏è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `app2.py` –≤ –ø–∞–ø–∫–µ `faststream-tutorial` –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞:

```python
--8<-- "src/tutorial/inter_service/app2.py"
```

**–ß—Ç–æ –∑–¥–µ—Å—å –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç?** ü§î

- **`@broker.subscriber("final-queue")`**: –î–µ–∫–æ—Ä–∞—Ç–æ—Ä, —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—â–∏–π —Ñ—É–Ω–∫—Ü–∏—é `final_result` –∫–∞–∫ –ø–æ–¥–ø–∏—Å—á–∏–∫–∞ –Ω–∞ –æ—á–µ—Ä–µ–¥—å `final-queue`.
- **`final_result`**: –§—É–Ω–∫—Ü–∏—è-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫, –∫–æ—Ç–æ—Ä–∞—è –ª–æ–≥–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ `final-queue`, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—è –≤—Ç–æ—Ä–æ–π —Å–µ—Ä–≤–∏—Å, –ø–æ—Ç—Ä–µ–±–ª—è—é—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–µ—Ä–≤–æ–≥–æ.

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± –æ—Ç–ø—Ä–∞–≤–∫–∏** üì§  
–í `app.py` –≤–º–µ—Å—Ç–æ `broker.publish` –≤ `handle_message` –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä `@broker.publisher`:

```python
@broker.subscriber("input-queue")
@broker.publisher("output-queue")
@broker.publisher("final-queue")
async def handle_message(msg: str, logger: Logger) -> str:
    logger.info(f"–ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ: {msg}")
    return f"–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ: {msg.upper()}"
```

**–ü–æ—Ä—è–¥–æ–∫ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–æ–≤** üîç  
–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ `@broker.publisher`, –ø–æ—Ä—è–¥–æ–∫ –≤–∞–∂–µ–Ω:

- `@broker.subscriber` ‚Äî **–≤–Ω–µ—à–Ω–∏–π** (–≤—ã—à–µ), —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é –∫–∞–∫ –ø–æ–¥–ø–∏—Å—á–∏–∫–∞.
- `@broker.publisher` ‚Äî **–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π** (–Ω–∏–∂–µ), –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏.  

–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ `@broker.publisher` –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –æ—á–µ—Ä–µ–¥–µ–π, –∫–∞–∫ –≤ –ø—Ä–∏–º–µ—Ä–µ –≤—ã—à–µ. –í Python –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Å–Ω–∏–∑—É –≤–≤–µ—Ä—Ö, –ø–æ—ç—Ç–æ–º—É `@broker.publisher` –æ–±–æ—Ä–∞—á–∏–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é –ø–µ—Ä–≤–æ–π, –∞ `@broker.subscriber` ‚Äî –ø–æ—Å–ª–µ–¥–Ω–µ–π.

**–ü–æ—á–µ–º—É –¥–≤–∞ —Å–µ—Ä–≤–∏—Å–∞?** üåê  

- `app.py`: –ü–µ—Ä–≤—ã–π —Å–µ—Ä–≤–∏—Å –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (`input-queue`) –∏ –ø—É–±–ª–∏–∫—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ `output-queue` (–¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è) –∏ `final-queue` (–¥–ª—è –≤–Ω–µ—à–Ω–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞).
- `app2.py`: –í—Ç–æ—Ä–æ–π —Å–µ—Ä–≤–∏—Å –ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ `final-queue`, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—è –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π).  

–≠—Ç–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ä–µ–∞–ª—å–Ω—É—é –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É, –≥–¥–µ —Å–µ—Ä–≤–∏—Å—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—Ç —á–µ—Ä–µ–∑ –±—Ä–æ–∫–µ—Ä.

## –®–∞–≥ 3: –ü—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π üîå

–í–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è —Ä–∞–Ω–µ–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–º —Å–∫—Ä–∏–ø—Ç–æ–º `send_message.py`:

```python
--8<-- "src/tutorial/send_message.py"
```

**–ü–æ—á–µ–º—É –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä?** üîç –°–∫—Ä–∏–ø—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —Å `broker.publish`, –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—è –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤, –ø–æ—ç—Ç–æ–º—É `async with` –≤—ã–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ `broker.connect()` –∏ `broker.close()`. –≠—Ç–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –¥–ª—è –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏.

## –®–∞–≥ 4: –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π ‚ñ∂Ô∏è

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ RabbitMQ –∑–∞–ø—É—â–µ–Ω (—Å–º. [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞](./setup.md)). –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Docker, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä:

```bash
docker ps
```

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ–±–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ **–æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ç–µ—Ä–º–∏–Ω–∞–ª–∞—Ö**:

1. **–î–ª—è –ø–µ—Ä–≤–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ (`app.py`)**:

    ```bash
    faststream run app:app
    ```

    –í—ã–≤–æ–¥:

    ```
    INFO     - FastStream app starting...
    INFO     - input-queue  |            - `handle_message` waiting for messages
    INFO     - output-queue |            - `check_result` waiting for messages
    INFO     - FastStream app started successfully! To exit press CTRL+C
    ```

2. **–î–ª—è –≤—Ç–æ—Ä–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ (`app2.py`)**:

    ```bash
    faststream run app2:app
    ```
    –í—ã–≤–æ–¥:

    ```
    INFO     - FastStream app starting...
    INFO     - final-queue  |            - `final_result` waiting for messages
    INFO     - FastStream app started successfully! To exit press CTRL+C
    ```

–û–±–∞ —Å–µ—Ä–≤–∏—Å–∞ —Ç–µ–ø–µ—Ä—å —Å–ª—É—à–∞—é—Ç —Å–≤–æ–∏ –æ—á–µ—Ä–µ–¥–∏ –∏ –≥–æ—Ç–æ–≤—ã –∫ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—é! üéâ

## –®–∞–≥ 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è üì¨

–û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:

```bash
python send_message.py
```

**–í—ã–≤–æ–¥ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ `app.py`**:
```
INFO     - input-queue  |            - –ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ: –ü—Ä–∏–≤–µ—Ç, FastStream!
INFO     - output-queue |            - –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ: –ü–†–ò–í–ï–¢, FASTSTREAM!
```

**–í—ã–≤–æ–¥ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ `app2.py`**:
```
INFO     - final-queue  |            - –§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ: –ü–†–ò–í–ï–¢, FASTSTREAM!
```

**–ß—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ?** üîÑ

1. –°–∫—Ä–∏–ø—Ç `send_message.py` –æ—Ç–ø—Ä–∞–≤–∏–ª —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ `input-queue`.
2. –ü–µ—Ä–≤—ã–π —Å–µ—Ä–≤–∏—Å (`app.py`):
   - –ü–æ–¥–ø–∏—Å—á–∏–∫ `handle_message` –æ–±—Ä–∞–±–æ—Ç–∞–ª —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ `input-queue` –∏ –æ—Ç–ø—Ä–∞–≤–∏–ª —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ `output-queue` –∏ `final-queue`.
   - –ü–æ–¥–ø–∏—Å—á–∏–∫ `check_result` –ø–æ–ª—É—á–∏–ª —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ `output-queue` –∏ –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞–ª –µ–≥–æ –∫–∞–∫ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
3. –í—Ç–æ—Ä–æ–π —Å–µ—Ä–≤–∏—Å (`app2.py`):
   - –ü–æ–¥–ø–∏—Å—á–∏–∫ `final_result` –ø–æ–ª—É—á–∏–ª —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ `final-queue` –∏ –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞–ª –µ–≥–æ –∫–∞–∫ —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

–≠—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ –¥–≤–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö —Å–µ—Ä–≤–∏—Å–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—Ç —á–µ—Ä–µ–∑ –±—Ä–æ–∫–µ—Ä, –æ–±–º–µ–Ω–∏–≤–∞—è—Å—å –¥–∞–Ω–Ω—ã–º–∏ —á–µ—Ä–µ–∑ –æ—á–µ—Ä–µ–¥–∏! üåê

## –®–∞–≥ 6: –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ üìö

–ó–∞–∫—Ä–µ–ø–∏—Ç–µ –∑–Ω–∞–Ω–∏—è:

1. –ò–∑–º–µ–Ω–∏—Ç–µ `final_result` –≤ `app2.py`, —á—Ç–æ–±—ã –æ–Ω–∞ –¥–æ–±–∞–≤–ª—è–ª–∞ –¥—Ä—É–≥–æ–π –ø—Ä–µ—Ñ–∏–∫—Å, –Ω–∞–ø—Ä–∏–º–µ—Ä, `–ü–æ–ª—É—á–µ–Ω–æ –≤ —Å–µ—Ä–≤–∏—Å–µ B: {msg}`.
2. –ü–µ—Ä–µ–ø–∏—à–∏—Ç–µ `handle_message` –≤ `app.py` —Å `@broker.publisher` –¥–ª—è –æ–±–µ–∏—Ö –æ—á–µ—Ä–µ–¥–µ–π (`output-queue` –∏ `final-queue`), —Å–æ—Ö—Ä–∞–Ω–∏–≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–æ–≤, –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
3. (–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ) –°–æ–∑–¥–∞–π—Ç–µ —Ç—Ä–µ—Ç–∏–π —Å–µ—Ä–≤–∏—Å (`app3.py`), –∫–æ—Ç–æ—Ä—ã–π —Å–ª—É—à–∞–µ—Ç –Ω–æ–≤—É—é –æ—á–µ—Ä–µ–¥—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, `archive-queue`), –∫—É–¥–∞ `app2.py` –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏. –û–±–Ω–æ–≤–∏—Ç–µ `app2.py`, —á—Ç–æ–±—ã –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –≤ `archive-queue`.

## –ß—Ç–æ –¥–∞–ª—å—à–µ? üó∫Ô∏è

–í—ã –Ω–∞—É—á–∏–ª–∏—Å—å —Å–æ–∑–¥–∞–≤–∞—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—Ç —á–µ—Ä–µ–∑ –±—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π! üéâ –≠—Ç–æ –æ—Å–Ω–æ–≤–∞ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã—Ö —Å–∏—Å—Ç–µ–º. –í —Å–ª–µ–¥—É—é—â–µ–º —Ä–∞–∑–¥–µ–ª–µ –º—ã –¥–æ–±–∞–≤–∏–º —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é **Pydantic**, —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω—ã–º–∏. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –∫ [**–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å Pydantic**](./pydantic.md), —á—Ç–æ–±—ã –æ—Å–≤–æ–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é JSON.

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –∏–¥–µ–∏, –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –Ω—É–∂–Ω–∞ –ø–æ–º–æ—â—å, –∑–∞–≥–ª—è–Ω–∏—Ç–µ –≤ [–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é FastStream](https://faststream.airt.ai/latest/), –ø–∏—à–∏—Ç–µ –≤ [Telegram](https://t.me/python_faststream) –∏–ª–∏ [Discord](https://discord.gg/qFm6aSqq59). –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ —Å–æ–µ–¥–∏–Ω—è—Ç—å —Å–µ—Ä–≤–∏—Å—ã! üöÄ
